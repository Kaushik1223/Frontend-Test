// App.jsx
import React, { useState } from 'react';
import Navbar from './components/Navbar';
import FileUpload from './components/FileUpload';
import ReconcileButton from './components/ReconcileButton';
import Footer from './components/Footer';
import TextContainer from './components/TextContainer';
import ShowResultButton from './components/ShowResultButton';
import LogOffModal from './components/LogOffModal';
import ProgressBar from './components/ProgressBar';
import './App.css';

function App() {
  const [isLogOffModalOpen, setIsLogOffModalOpen] = useState(false);
  const [progress, setProgress] = useState(0);
  const [reconciliationCompleted, setReconciliationCompleted] = useState(false);

  const handleLogOff = () => {
    setIsLogOffModalOpen(true);
  };

  const handleSignIn = () => {
    setIsLogOffModalOpen(false);
  };

  const handleReconcile = () => {
    setProgress(0); // Reset progress
    setReconciliationCompleted(false); // Reset reconciliation status
    let progressValue = 0;
    const interval = setInterval(() => {
      progressValue += 10;
      if (progressValue <= 100) {
        setProgress(progressValue);
      } else {
        clearInterval(interval);
        setReconciliationCompleted(true); // Set reconciliation status to complete
      }
    }, 500); // Adjust this interval and increment as needed
  };

  return (
    <div className="App">
      <Navbar onLogOff={handleLogOff} />
      <LogOffModal isOpen={isLogOffModalOpen} onClose={handleSignIn} />
      <TextContainer />
      <main className="main-content">
        <div className="upload">
          <FileUpload name="Upload Invoice" />
          <FileUpload name="Upload Confirmations" />
        </div>
        {!reconciliationCompleted ? (
          <ReconcileButton onClick={handleReconcile} />
        ) : (
          <p className="completion-message">Reconciliation completed</p>
        )}
        {progress > 0 && <ProgressBar progress={progress} />}
      </main>
      <div className='result-wrapper'>
        <ShowResultButton />
      </div>
      <Footer />
    </div>
  );
}

export default App;
